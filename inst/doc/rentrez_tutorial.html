<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="David winter" />

<meta name="date" content="2016-03-16" />

<title>Rentrez Tutorial</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Rentrez Tutorial</h1>
<h4 class="author"><em>David winter</em></h4>
<h4 class="date"><em>2016-03-16</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#introduction-the-ncbi-entrez-and-rentrez.">Introduction: The NCBI, entrez and <code>rentrez</code>.</a></li>
<li><a href="#getting-started-with-the-rentrez">Getting started with the rentrez</a></li>
<li><a href="#searching-databases-entrez_search">Searching databases: <code>entrez_search()</code></a><ul>
<li><a href="#building-search-terms">Building search terms</a></li>
<li><a href="#precise-queries-using-mesh-terms">Precise queries using MeSH terms</a></li>
<li><a href="#advanced-counting">Advanced counting</a></li>
</ul></li>
<li><a href="#finding-cross-references-entrez_link">Finding cross-references : <code>entrez_link()</code>:</a><ul>
<li><a href="#my-god-its-full-of-links">My god, it’s full of links</a></li>
<li><a href="#narrowing-our-focus">Narrowing our focus</a></li>
<li><a href="#external-links">External links</a></li>
<li><a href="#using-more-than-one-id">Using more than one ID</a></li>
</ul></li>
<li><a href="#getting-summary-data-entrez_summary">Getting summary data: <code>entrez_summary()</code></a><ul>
<li><a href="#the-summary-record">The summary record</a></li>
<li><a href="#dealing-with-many-records">Dealing with many records</a></li>
</ul></li>
<li><a href="#fetching-full-records-entrez_fetch">Fetching full records: <code>entrez_fetch()</code></a><ul>
<li><a href="#fetch-dna-sequences-in-fasta-format">Fetch DNA sequences in fasta format</a></li>
<li><a href="#fetch-a-parsed-xml-document">Fetch a parsed XML document</a></li>
</ul></li>
<li><a href="#using-ncbis-web-history-features">Using NCBI’s Web History features</a><ul>
<li><a href="#post-a-set-of-ids-to-the-ncbi-for-later-use-entrez_post">Post a set of IDs to the NCBI for later use: <code>entrez_post()</code></a></li>
<li><a href="#get-a-web_history-object-from-entrez_search-or-entrez_link">Get a <code>web_history</code> object from <code>entrez_search</code> or <code>entrez_link()</code></a></li>
<li><a href="#use-a-web_history-object">Use a <code>web_history</code> object</a></li>
</ul></li>
<li><a href="#what-next">What next ?</a></li>
</ul>
</div>

<div id="introduction-the-ncbi-entrez-and-rentrez." class="section level2">
<h2>Introduction: The NCBI, entrez and <code>rentrez</code>.</h2>
<p>The NCBI shares a <em>lot</em> of data. At the time this document was compiled, there were 25.9 million papers in <a href="http://www.ncbi.nlm.nih.gov/pubmed/">PubMed</a>, including 3.9 million full-text records available in <a href="http://www.ncbi.nlm.nih.gov/pubmed/">PubMed Central</a>. <a href="http://www.ncbi.nlm.nih.gov/nuccore">The NCBI Nucleotide Database</a> (which includes GenBank) has data for 196 million different sequences, and <a href="http://www.ncbi.nlm.nih.gov/snp/">dbSNP</a> describes 769.3 million different genetic variants. All of these records can be cross-referenced with the 1.11 million species in the <a href="www.ncbi.nlm.nih.gov/taxonomy">NCBI taxonomy</a> or 24.4 thousand disease-associated records in <a href="http://www.ncbi.nlm.nih.gov/omim">OMIM</a>.</p>
<p>The NCBI makes this data available through a <a href="http://www.ncbi.nlm.nih.gov/">web interface</a>, an <a href="ftp://ftp.ncbi.nlm.nih.gov/">FTP server</a> and through a REST API called the <a href="http://www.ncbi.nlm.nih.gov/books/NBK25500/">Entrez Utilities</a> (<code>Eutils</code> for short). This package provides functions to use that API, allowing users to gather and combine data from multiple NCBI databases in the comfort of an R session or script.</p>
</div>
<div id="getting-started-with-the-rentrez" class="section level2">
<h2>Getting started with the rentrez</h2>
<p>To make the most of all the data the NCBI shares you need to know a little about their databases, the records they contain and the ways you can find those records. The <a href="http://www.ncbi.nlm.nih.gov/home/documentation.shtml">NCBI provides extensive documentation for each of their databases</a> and for the <a href="http://www.ncbi.nlm.nih.gov/books/NBK25501/">EUtils API that <code>rentrez</code> takes advantage of</a>. There are also some helper functions in <code>rentrez</code> that help users learn their way around the NCBI’s databases.</p>
<p>First, you can use <code>entrez_dbs()</code> to find the list of available databases:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_dbs</span>()</code></pre>
<pre><code>##  [1] &quot;pubmed&quot;          &quot;protein&quot;         &quot;nuccore&quot;        
##  [4] &quot;nucleotide&quot;      &quot;nucgss&quot;          &quot;nucest&quot;         
##  [7] &quot;structure&quot;       &quot;genome&quot;          &quot;annotinfo&quot;      
## [10] &quot;assembly&quot;        &quot;bioproject&quot;      &quot;biosample&quot;      
## [13] &quot;blastdbinfo&quot;     &quot;books&quot;           &quot;cdd&quot;            
## [16] &quot;clinvar&quot;         &quot;clone&quot;           &quot;gap&quot;            
## [19] &quot;gapplus&quot;         &quot;grasp&quot;           &quot;dbvar&quot;          
## [22] &quot;epigenomics&quot;     &quot;gene&quot;            &quot;gds&quot;            
## [25] &quot;geoprofiles&quot;     &quot;homologene&quot;      &quot;medgen&quot;         
## [28] &quot;mesh&quot;            &quot;ncbisearch&quot;      &quot;nlmcatalog&quot;     
## [31] &quot;omim&quot;            &quot;orgtrack&quot;        &quot;pmc&quot;            
## [34] &quot;popset&quot;          &quot;probe&quot;           &quot;proteinclusters&quot;
## [37] &quot;pcassay&quot;         &quot;biosystems&quot;      &quot;pccompound&quot;     
## [40] &quot;pcsubstance&quot;     &quot;pubmedhealth&quot;    &quot;seqannot&quot;       
## [43] &quot;snp&quot;             &quot;sra&quot;             &quot;taxonomy&quot;       
## [46] &quot;unigene&quot;         &quot;gencoll&quot;         &quot;gtr&quot;</code></pre>
<p>There is a set of functions with names starting <code>entrez_db_</code> that can be used to gather more information about each of these databases:</p>
<p><strong>Functions that help you learn about NCBI databases</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Function name</th>
<th align="left">Return</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>entrez_db_summary()</code></td>
<td align="left">Brief description of what the database is</td>
</tr>
<tr class="even">
<td align="left"><code>entrez_db_searchable()</code></td>
<td align="left">Set of search terms that can used with this database</td>
</tr>
<tr class="odd">
<td align="left"><code>entrez_db_links()</code></td>
<td align="left">Set of databases that might contain linked records</td>
</tr>
</tbody>
</table>
<p>For instance, we can get a description of the somewhat cryptically named database ‘cdd’…</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_db_summary</span>(<span class="st">&quot;cdd&quot;</span>)</code></pre>
<pre><code>##  DbName: cdd
##  MenuName: Conserved Domains
##  Description: Conserved Domain Database
##  DbBuild: Build150814-1106.1
##  Count: 50648
##  LastUpdate: 2016/03/02 20:42</code></pre>
<p>… or find out which search terms can be used with the Sequence Read Archive (SRA) database (which contains raw data from sequencing projects):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_db_searchable</span>(<span class="st">&quot;sra&quot;</span>)</code></pre>
<pre><code>## Searchable fields for database 'sra'
##   ALL     All terms from all searchable fields 
##   UID     Unique number assigned to publication 
##   FILT    Limits the records 
##   ACCN    Accession number of sequence 
##   TITL    Words in definition line 
##   PROP    Classification by source qualifiers and molecule type 
##   WORD    Free text associated with record 
##   ORGN    Scientific and common names of organism, and all higher levels of taxonomy 
##   AUTH    Author(s) of publication 
##   PDAT    Date sequence added to GenBank 
##   MDAT    Date of last update 
##   GPRJ    BioProject 
##   BSPL    BioSample</code></pre>
<p>Just how these ‘helper’ functions might be useful will become clearer once you’ve started using <code>rentrez</code>, so let’s get started.</p>
</div>
<div id="searching-databases-entrez_search" class="section level2">
<h2>Searching databases: <code>entrez_search()</code></h2>
<p>Very often, the first thing you’ll want to do with <code>rentrez</code> is search a given NCBI database to find records that match some keywords. You can do this using the function <code>entrez_search()</code>. In the simplest case you just need to provide a database name (<code>db</code>) and a search term (<code>term</code>) so let’s search PubMed for articles about the <code>R language</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">r_search &lt;-<span class="st"> </span><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;pubmed&quot;</span>, <span class="dt">term=</span><span class="st">&quot;R Language&quot;</span>)</code></pre>
<p>The object returned by a search acts like a list, and you can get a summary of its contents by printing it.</p>
<pre class="sourceCode r"><code class="sourceCode r">r_search</code></pre>
<pre><code>## Entrez search result with 8904 hits (object contains 20 IDs and no web_history object)
##  Search term (as translated):  R[All Fields] AND (&quot;programming languages&quot;[MeSH Te ...</code></pre>
<p>There are a few things to note here. First, the NCBI’s server has worked out that we meant R as a programming language, and so included the <a href="http://www.ncbi.nlm.nih.gov/mesh">‘MeSH’ term</a> term associated with programming languages. We’ll worry about MeSH terms and other special queries later, for now just note that you can use this feature to check that your search term was interpreted in the way you intended. Second, there are many more ‘hits’ for this search than there are unique IDs contained in this object. That’s because the optional argument <code>retmax</code>, which controls the maximum number of returned values has a default value of 20.</p>
<p>The IDs are the most important thing returned here. They allow us to fetch records matching those IDs, gather summary data about them or find cross-referenced records in other databases. We access the IDs as a vector using the <code>$</code> operator:</p>
<pre class="sourceCode r"><code class="sourceCode r">r_search$ids</code></pre>
<pre><code>##  [1] &quot;26972963&quot; &quot;26971276&quot; &quot;26968622&quot; &quot;26968611&quot; &quot;26966658&quot; &quot;26963255&quot;
##  [7] &quot;26962759&quot; &quot;26962052&quot; &quot;26961972&quot; &quot;26961363&quot; &quot;26954990&quot; &quot;26954860&quot;
## [13] &quot;26952709&quot; &quot;26951063&quot; &quot;26949065&quot; &quot;26937383&quot; &quot;26934820&quot; &quot;26933939&quot;
## [19] &quot;26932818&quot; &quot;26931139&quot;</code></pre>
<p>If we want to get more than 20 IDs we can do so by increasing the <code>ret_max</code> argument.</p>
<pre class="sourceCode r"><code class="sourceCode r">another_r_search &lt;-<span class="st"> </span><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;pubmed&quot;</span>, <span class="dt">term=</span><span class="st">&quot;R Language&quot;</span>, <span class="dt">retmax=</span><span class="dv">40</span>)
another_r_search</code></pre>
<pre><code>## Entrez search result with 8904 hits (object contains 40 IDs and no web_history object)
##  Search term (as translated):  R[All Fields] AND (&quot;programming languages&quot;[MeSH Te ...</code></pre>
<p>If we want to get IDs for all of the thousands of records that match this search, we can use the NCBI’s web history feature <a href="#web_history">described below</a>.</p>
<div id="building-search-terms" class="section level3">
<h3>Building search terms</h3>
<p>The EUtils API uses a special syntax to build search terms. You can search a database against a specific term using the format <code>query[SEARCH FIELD]</code>, and combine multiple such searches using the boolean operators <code>AND</code>, <code>OR</code> and <code>NOT</code>.</p>
<p>For instance, we can find next generation sequence datasets for the (amazing…) ciliate <em>Tetrahymena thermophila</em> by using the organism (‘ORGN’) search field:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;sra&quot;</span>,
              <span class="dt">term=</span><span class="st">&quot;Tetrahymena thermophila[ORGN]&quot;</span>,
              <span class="dt">retmax=</span><span class="dv">0</span>)</code></pre>
<pre><code>## Entrez search result with 119 hits (object contains 0 IDs and no web_history object)
##  Search term (as translated):  &quot;Tetrahymena thermophila&quot;[Organism]</code></pre>
<p>We can narrow our focus to only those records that have been added recently (using the colon to specify a range of values):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;sra&quot;</span>,
              <span class="dt">term=</span><span class="st">&quot;Tetrahymena thermophila[ORGN] AND 2013:2015[PDAT]&quot;</span>,
              <span class="dt">retmax=</span><span class="dv">0</span>)</code></pre>
<pre><code>## Entrez search result with 75 hits (object contains 0 IDs and no web_history object)
##  Search term (as translated):  &quot;Tetrahymena thermophila&quot;[Organism] AND 2013[PDAT] ...</code></pre>
<p>Or include recent records for either <em>T. thermophila</em> or it’s close relative <em>T. borealis</em> (using parentheses to make ANDs and ORs explicit).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;sra&quot;</span>,
              <span class="dt">term=</span><span class="st">&quot;(Tetrahymena thermophila[ORGN] OR Tetrahymena borealis[ORGN]) AND 2013:2015[PDAT]&quot;</span>,
              <span class="dt">retmax=</span><span class="dv">0</span>)</code></pre>
<pre><code>## Entrez search result with 75 hits (object contains 0 IDs and no web_history object)
##  Search term (as translated):  (&quot;Tetrahymena thermophila&quot;[Organism] OR &quot;Tetrahyme ...</code></pre>
<p>The set of search terms available varies between databases. You can get a list of available terms or any given data base with <code>entrez_db_searchable()</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_db_searchable</span>(<span class="st">&quot;sra&quot;</span>)</code></pre>
<pre><code>## Searchable fields for database 'sra'
##   ALL     All terms from all searchable fields 
##   UID     Unique number assigned to publication 
##   FILT    Limits the records 
##   ACCN    Accession number of sequence 
##   TITL    Words in definition line 
##   PROP    Classification by source qualifiers and molecule type 
##   WORD    Free text associated with record 
##   ORGN    Scientific and common names of organism, and all higher levels of taxonomy 
##   AUTH    Author(s) of publication 
##   PDAT    Date sequence added to GenBank 
##   MDAT    Date of last update 
##   GPRJ    BioProject 
##   BSPL    BioSample</code></pre>
</div>
<div id="precise-queries-using-mesh-terms" class="section level3">
<h3>Precise queries using MeSH terms</h3>
<p>In addition to the search terms described above, the NCBI allows searches using <a href="http://www.ncbi.nlm.nih.gov/mesh">Medical Subject Heading (MeSH)</a> terms. These terms create a ‘controlled vocabulary’, and allow users to make very finely controlled queries of databases.</p>
<p>For instance, if you were interested in reviewing studies on how a class of anti-malarial drugs called Folic Acid Antagonists work against <em>Plasmodium vivax</em> (a particular species of malarial parasite), you could use this search:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_search</span>(<span class="dt">db   =</span> <span class="st">&quot;pubmed&quot;</span>,
              <span class="dt">term =</span> <span class="st">&quot;(vivax malaria[MeSH]) AND (folic acid antagonists[MeSH])&quot;</span>)</code></pre>
<pre><code>## Entrez search result with 11 hits (object contains 11 IDs and no web_history object)
##  Search term (as translated):  &quot;malaria, vivax&quot;[MeSH Terms] AND &quot;folic acid antag ...</code></pre>
<p>The complete set of MeSH terms is available as a database from the NCBI. That means it is possible to download detailed information about each term and find the ways in which terms relate to each other using <code>rentrez</code>. You can search for specific terms with <code>entrez_search(db=&quot;mesh&quot;, term =...)</code> and learn about the results of your search using the tools described below.</p>
</div>
<div id="advanced-counting" class="section level3">
<h3>Advanced counting</h3>
<p>As you can see above, the object returned by <code>entrez_search()</code> includes the number of records matching a given search. This means you can learn a little about the composition of, or trends in, the records stored in the NCBI’s databases using only the search utility. For instance, let’s track the rise of the scientific buzzword “connectome” in PubMed, programmatically creating search terms for the <code>PDAT</code> field:</p>
<pre class="sourceCode r"><code class="sourceCode r">search_year &lt;-<span class="st"> </span>function(year, term){
    query &lt;-<span class="st"> </span><span class="kw">paste</span>(term, <span class="st">&quot;AND (&quot;</span>, year, <span class="st">&quot;[PDAT])&quot;</span>)
    <span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;pubmed&quot;</span>, <span class="dt">term=</span>query, <span class="dt">retmax=</span><span class="dv">0</span>)$count
}

year &lt;-<span class="st"> </span><span class="dv">2008</span>:<span class="dv">2014</span>
papers &lt;-<span class="st"> </span><span class="kw">sapply</span>(year, search_year, <span class="dt">term=</span><span class="st">&quot;Connectome&quot;</span>, <span class="dt">USE.NAMES=</span><span class="ot">FALSE</span>)

<span class="kw">plot</span>(year, papers, <span class="dt">type=</span><span class="st">'b'</span>, <span class="dt">main=</span><span class="st">&quot;The Rise of the Connectome&quot;</span>)</code></pre>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="finding-cross-references-entrez_link" class="section level2">
<h2>Finding cross-references : <code>entrez_link()</code>:</h2>
<p>One of the strengths of the NCBI databases is the degree to which records of one type are connected to other records within the NCBI or to external data sources. The function <code>entrez_link()</code> allows users to discover these links between records.</p>
<div id="my-god-its-full-of-links" class="section level3">
<h3>My god, it’s full of links</h3>
<p>To get an idea of the degree to which records in the NCBI are cross-linked we can find all NCBI data associated with a single gene (in this case the Amyloid Beta Precursor gene, the product of which is associated with the plaques that form in the brains of Alzheimer’s Disease patients).</p>
<p>The function <code>entrez_link()</code> can be used to find cross-referenced records. In the most basic case we need to provide an ID (<code>id</code>), the database from which this ID comes (<code>dbfrom</code>) and the name of a database in which to find linked records (<code>db</code>). If we set this last argument to ‘all’ we can find links in multiple databases:</p>
<pre class="sourceCode r"><code class="sourceCode r">all_the_links &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">dbfrom=</span><span class="st">'gene'</span>, <span class="dt">id=</span><span class="dv">351</span>, <span class="dt">db=</span><span class="st">'all'</span>)
all_the_links</code></pre>
<pre><code>## elink object with contents:
##  $links: IDs for linked records from NCBI
## </code></pre>
<p>Just as with <code>entrez_search</code> the returned object behaves like a list, and we can learn a little about its contents by printing it. In the case, all of the information is in <code>links</code> (and there’s a lot of them!):</p>
<pre class="sourceCode r"><code class="sourceCode r">all_the_links$links</code></pre>
<pre><code>## elink result with information from 53 databases:
##  [1] gene_bioconcepts               gene_biosystems               
##  [3] gene_biosystems_all            gene_clinvar                  
##  [5] gene_dbvar                     gene_gene_h3k4me3             
##  [7] gene_genome                    gene_gtr                      
##  [9] gene_medgen_diseases           gene_pcassay                  
## [11] gene_pcassay_alltarget_list    gene_pcassay_alltarget_summary
## [13] gene_pcassay_rnai              gene_pcassay_target           
## [15] gene_probe                     gene_structure                
## [17] gene_bioproject                gene_books                    
## [19] gene_cdd                       gene_gene_neighbors           
## [21] gene_genereviews               gene_genome2                  
## [23] gene_geoprofiles               gene_homologene               
## [25] gene_nuccore                   gene_nuccore_mgc              
## [27] gene_nuccore_pos               gene_nuccore_refseqgene       
## [29] gene_nuccore_refseqrna         gene_nucest                   
## [31] gene_nucest_clust              gene_nucleotide               
## [33] gene_nucleotide_clust          gene_nucleotide_mgc           
## [35] gene_nucleotide_mgc_url        gene_nucleotide_pos           
## [37] gene_omim                      gene_pcassay_proteintarget    
## [39] gene_pccompound                gene_pcsubstance              
## [41] gene_pmc                       gene_pmc_nucleotide           
## [43] gene_protein                   gene_protein_refseq           
## [45] gene_pubmed                    gene_pubmed_citedinomim       
## [47] gene_pubmed_pmc_nucleotide     gene_pubmed_rif               
## [49] gene_snp                       gene_snp_geneview             
## [51] gene_taxonomy                  gene_unigene                  
## [53] gene_varview</code></pre>
<p>The names of the list elements are in the format <code>[source_database]_[linked_database]</code> and the elements themselves contain a vector of linked-IDs. So, if we want to find open access publications associated with this gene we could get linked records in PubMed Central:</p>
<pre class="sourceCode r"><code class="sourceCode r">all_the_links$links$gene_pmc[<span class="dv">1</span>:<span class="dv">10</span>]</code></pre>
<pre><code>##  [1] &quot;4648968&quot; &quot;4528011&quot; &quot;4502972&quot; &quot;4496119&quot; &quot;4476499&quot; &quot;4467552&quot; &quot;4440096&quot;
##  [8] &quot;4418866&quot; &quot;4410718&quot; &quot;4407201&quot;</code></pre>
<p>Or if were interested in this gene’s role in diseases we could find links to clinVar:</p>
<pre class="sourceCode r"><code class="sourceCode r">all_the_links$links$gene_clinvar</code></pre>
<pre><code>##  [1] &quot;160886&quot; &quot;155682&quot; &quot;155309&quot; &quot;155093&quot; &quot;155053&quot; &quot;154360&quot; &quot;154063&quot;
##  [8] &quot;153438&quot; &quot;152839&quot; &quot;151388&quot; &quot;150018&quot; &quot;149551&quot; &quot;149418&quot; &quot;149160&quot;
## [15] &quot;149035&quot; &quot;148411&quot; &quot;148262&quot; &quot;148180&quot; &quot;146125&quot; &quot;145984&quot; &quot;145474&quot;
## [22] &quot;145468&quot; &quot;145332&quot; &quot;145107&quot; &quot;144677&quot; &quot;144194&quot; &quot;127268&quot; &quot;98242&quot; 
## [29] &quot;98241&quot;  &quot;98240&quot;  &quot;98239&quot;  &quot;98238&quot;  &quot;98237&quot;  &quot;98236&quot;  &quot;98235&quot; 
## [36] &quot;59247&quot;  &quot;59246&quot;  &quot;59245&quot;  &quot;59243&quot;  &quot;59226&quot;  &quot;59224&quot;  &quot;59223&quot; 
## [43] &quot;59222&quot;  &quot;59221&quot;  &quot;59010&quot;  &quot;59005&quot;  &quot;59004&quot;  &quot;37145&quot;  &quot;32099&quot; 
## [50] &quot;18106&quot;  &quot;18105&quot;  &quot;18104&quot;  &quot;18103&quot;  &quot;18102&quot;  &quot;18101&quot;  &quot;18100&quot; 
## [57] &quot;18099&quot;  &quot;18098&quot;  &quot;18097&quot;  &quot;18096&quot;  &quot;18095&quot;  &quot;18094&quot;  &quot;18093&quot; 
## [64] &quot;18092&quot;  &quot;18091&quot;  &quot;18090&quot;  &quot;18089&quot;  &quot;18088&quot;  &quot;18087&quot;</code></pre>
</div>
<div id="narrowing-our-focus" class="section level3">
<h3>Narrowing our focus</h3>
<p>If we know beforehand what sort of links we’d like to find , we can to use the <code>db</code> argument to narrow the focus of a call to <code>entrez_link</code>.</p>
<p>For instance, say we are interested in knowing about all of the RNA transcripts associated with the Amyloid Beta Precursor gene in humans. Transcript sequences are stored in the nucleotide database (referred to as <code>nuccore</code> in EUtils), so to find transcripts associated with a given gene we need to set <code>dbfrom=gene</code> and <code>db=nuccore</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">nuc_links &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">dbfrom=</span><span class="st">'gene'</span>, <span class="dt">id=</span><span class="dv">351</span>, <span class="dt">db=</span><span class="st">'nuccore'</span>)
nuc_links</code></pre>
<pre><code>## elink object with contents:
##  $links: IDs for linked records from NCBI
## </code></pre>
<pre class="sourceCode r"><code class="sourceCode r">nuc_links$links</code></pre>
<pre><code>## elink result with information from 5 databases:
## [1] gene_nuccore            gene_nuccore_mgc        gene_nuccore_pos       
## [4] gene_nuccore_refseqgene gene_nuccore_refseqrna</code></pre>
<p>The object we get back contains links to the nucleotide database generally, but also to special subsets of that database like <a href="http://www.ncbi.nlm.nih.gov/refseq/">refseq</a>. We can take advantage of this narrower set of links to find IDs that match unique transcripts from our gene of interest.</p>
<pre class="sourceCode r"><code class="sourceCode r">nuc_links$links$gene_nuccore_refseqrna</code></pre>
<pre><code>##  [1] &quot;324021747&quot; &quot;324021746&quot; &quot;324021739&quot; &quot;324021737&quot; &quot;324021735&quot;
##  [6] &quot;228008405&quot; &quot;228008404&quot; &quot;228008403&quot; &quot;228008402&quot; &quot;228008401&quot;</code></pre>
<p>We can use these ids in calls to <code>entrez_fetch()</code> or <code>entrez_summary()</code> to learn more about the transcripts they represent.</p>
</div>
<div id="external-links" class="section level3">
<h3>External links</h3>
<p>In addition to finding data within the NCBI, <code>entrez_link</code> can turn up connections to external databases. Perhaps the most interesting example is finding links to the full text of papers in PubMed. For example, when I wrote this document the first paper linked to Amyloid Beta Precursor had a unique ID of <code>25500142</code>. We can find links to the full text of that paper with <code>entrez_link</code> by setting the <code>cmd</code> argument to ‘llinks’:</p>
<pre class="sourceCode r"><code class="sourceCode r">paper_links &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">dbfrom=</span><span class="st">&quot;pubmed&quot;</span>, <span class="dt">id=</span><span class="dv">25500142</span>, <span class="dt">cmd=</span><span class="st">&quot;llinks&quot;</span>)
paper_links</code></pre>
<pre><code>## elink object with contents:
##  $linkouts: links to external websites</code></pre>
<p>Each element of the <code>linkouts</code> object contains information about an external source of data on this paper:</p>
<pre class="sourceCode r"><code class="sourceCode r">paper_links$linkouts</code></pre>
<pre><code>## $ID_25500142
## $ID_25500142[[1]]
## Linkout from Elsevier Science 
##  $Url: http://linkinghub.elsevier ...
## 
## $ID_25500142[[2]]
## Linkout from Europe PubMed Central 
##  $Url: http://europepmc.org/abstr ...
## 
## $ID_25500142[[3]]
## Linkout from Ovid Technologies, Inc. 
##  $Url: http://ovidsp.ovid.com/ovi ...
## 
## $ID_25500142[[4]]
## Linkout from PubMed Central 
##  $Url: http://www.ncbi.nlm.nih.go ...
## 
## $ID_25500142[[5]]
## Linkout from Genetics Home Reference 
##  $Url: https://ghr.nlm.nih.gov/ge ...
## 
## $ID_25500142[[6]]
## Linkout from MedlinePlus Health Information 
##  $Url: https://www.nlm.nih.gov/me ...
## 
## $ID_25500142[[7]]
## Linkout from Mouse Genome Informatics (MGI) 
##  $Url: http://www.informatics.jax ...</code></pre>
<p>Each of those linkout objects contains quite a lot of information, but the URL is probably the most useful. For that reason, <code>rentrez</code> provides the function <code>linkout_urls</code> to make extracting just the URL simple:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">linkout_urls</span>(paper_links)</code></pre>
<pre><code>## $ID_25500142
## [1] &quot;http://linkinghub.elsevier.com/retrieve/pii/S0014-4886(14)00393-8&quot;      
## [2] &quot;http://europepmc.org/abstract/MED/25500142&quot;                             
## [3] &quot;http://ovidsp.ovid.com/ovidweb.cgi?T=JS&amp;PAGE=linkout&amp;SEARCH=25500142.ui&quot;
## [4] &quot;http://www.ncbi.nlm.nih.gov/pmc/articles/pmid/25500142/&quot;                
## [5] &quot;https://ghr.nlm.nih.gov/gene=APP&quot;                                       
## [6] &quot;https://www.nlm.nih.gov/medlineplus/alzheimersdisease.html&quot;             
## [7] &quot;http://www.informatics.jax.org/marker/reference/25500142&quot;</code></pre>
<p>The full list of options for the <code>cmd</code> argument are given in in-line documentation (<code>?entrez_link</code>). If you are interested in finding full text records for a large number of articles checkout the package <a href="https://github.com/ropensci/fulltext">fulltext</a> which makes use of multiple sources (including the NCBI) to discover the full text articles.</p>
</div>
<div id="using-more-than-one-id" class="section level3">
<h3>Using more than one ID</h3>
<p>It is possible to pass more than one ID to <code>entrez_link()</code>. By default, doing so will give you a single elink object containing the complete set of links for <em>all</em> of the IDs that you specified. So, if you were looking for protein IDs related to specific genes you could do:</p>
<pre class="sourceCode r"><code class="sourceCode r">all_links_together  &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">db=</span><span class="st">&quot;protein&quot;</span>, <span class="dt">dbfrom=</span><span class="st">&quot;gene&quot;</span>, <span class="dt">id=</span><span class="kw">c</span>(<span class="st">&quot;93100&quot;</span>, <span class="st">&quot;223646&quot;</span>))
all_links_together</code></pre>
<pre><code>## elink object with contents:
##  $links: IDs for linked records from NCBI
## </code></pre>
<pre class="sourceCode r"><code class="sourceCode r">all_links_together$links$gene_protein</code></pre>
<pre><code>##  [1] &quot;768043930&quot; &quot;767953815&quot; &quot;558472750&quot; &quot;194394158&quot; &quot;166221824&quot;
##  [6] &quot;154936864&quot; &quot;148697547&quot; &quot;148697546&quot; &quot;119602646&quot; &quot;119602645&quot;
## [11] &quot;119602644&quot; &quot;119602643&quot; &quot;119602642&quot; &quot;81899807&quot;  &quot;74215266&quot; 
## [16] &quot;74186774&quot;  &quot;37787317&quot;  &quot;37787309&quot;  &quot;37787307&quot;  &quot;37787305&quot; 
## [21] &quot;37589273&quot;  &quot;33991172&quot;  &quot;31982089&quot;  &quot;26339824&quot;  &quot;26329351&quot; 
## [26] &quot;21619615&quot;  &quot;10834676&quot;</code></pre>
<p>Although this behaviour might sometimes be useful, it means we’ve lost track of which <code>protein</code> ID is linked to which <code>gene</code> ID. To retain that information we can set <code>by_id</code> to <code>TRUE</code>. This gives us a list of elink objects, each once containing links from a single <code>gene</code> ID:</p>
<pre class="sourceCode r"><code class="sourceCode r">all_links_sep  &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">db=</span><span class="st">&quot;protein&quot;</span>, <span class="dt">dbfrom=</span><span class="st">&quot;gene&quot;</span>, <span class="dt">id=</span><span class="kw">c</span>(<span class="st">&quot;93100&quot;</span>, <span class="st">&quot;223646&quot;</span>), <span class="dt">by_id=</span><span class="ot">TRUE</span>)
all_links_sep</code></pre>
<pre><code>## List of 2 elink objects,each containing
##   $links: IDs for linked records from NCBI
## </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(all_links_sep, function(x) x$links$gene_protein)</code></pre>
<pre><code>## [[1]]
##  [1] &quot;768043930&quot; &quot;767953815&quot; &quot;558472750&quot; &quot;194394158&quot; &quot;166221824&quot;
##  [6] &quot;154936864&quot; &quot;119602646&quot; &quot;119602645&quot; &quot;119602644&quot; &quot;119602643&quot;
## [11] &quot;119602642&quot; &quot;37787309&quot;  &quot;37787307&quot;  &quot;37787305&quot;  &quot;33991172&quot; 
## [16] &quot;21619615&quot;  &quot;10834676&quot; 
## 
## [[2]]
##  [1] &quot;148697547&quot; &quot;148697546&quot; &quot;81899807&quot;  &quot;74215266&quot;  &quot;74186774&quot; 
##  [6] &quot;37787317&quot;  &quot;37589273&quot;  &quot;31982089&quot;  &quot;26339824&quot;  &quot;26329351&quot;</code></pre>
</div>
</div>
<div id="getting-summary-data-entrez_summary" class="section level2">
<h2>Getting summary data: <code>entrez_summary()</code></h2>
<p>Having found the unique IDs for some records via <code>entrez_search</code> or <code>entrez_link()</code>, you are probably going to want to learn something about them. The <code>Eutils</code> API has two ways to get information about a record. <code>entrez_fetch()</code> returns ‘full’ records in varying formats and <code>entrez_summary()</code> returns less information about each record, but in relatively simple format. Very often the summary records have the information you are after, so <code>rentrez</code> provides functions to parse and summarise summary records.</p>
<div id="the-summary-record" class="section level3">
<h3>The summary record</h3>
<p><code>entrez_summary()</code> takes a vector of unique IDs for the samples you want to get summary information from. Let’s start by finding out something about the paper describing <a href="https://github.com/ropensci/taxize">Taxize</a>, using its PubMed ID:</p>
<pre class="sourceCode r"><code class="sourceCode r">taxize_summ &lt;-<span class="st"> </span><span class="kw">entrez_summary</span>(<span class="dt">db=</span><span class="st">&quot;pubmed&quot;</span>, <span class="dt">id=</span><span class="dv">24555091</span>)
taxize_summ</code></pre>
<pre><code>## esummary result with 43 items:
##  [1] uid               pubdate           epubdate         
##  [4] source            authors           lastauthor       
##  [7] title             sorttitle         volume           
## [10] issue             pages             lang             
## [13] nlmuniqueid       issn              essn             
## [16] pubtype           recordstatus      pubstatus        
## [19] articleids        history           references       
## [22] attributes        pmcrefcount       fulljournalname  
## [25] elocationid       viewcount         doctype          
## [28] srccontriblist    booktitle         medium           
## [31] edition           publisherlocation publishername    
## [34] srcdate           reportnumber      availablefromurl 
## [37] locationlabel     doccontriblist    docdate          
## [40] bookname          chapter           sortpubdate      
## [43] sortfirstauthor</code></pre>
<p>Once again, the object returned by <code>entrez_summary</code> behaves like a list, so you can extract elements using <code>$</code>. For instance, we could convert our PubMed ID to another article identifier…</p>
<pre class="sourceCode r"><code class="sourceCode r">taxize_summ$articleids</code></pre>
<pre><code>##       idtype idtypen                           value
## 1        doi       3 10.12688/f1000research.2-191.v2
## 2     pubmed       1                        24555091
## 3        pmc       8                      PMC3901538
## 4        eid       8                        24555091
## 5        rid       8                        24563765
## 6    version       8                               2
## 7 version-id       8                               2
## 8      pmcid       5             pmc-id: PMC3901538;</code></pre>
<p>…or see how many times the article has been cited in PubMed Central papers</p>
<pre class="sourceCode r"><code class="sourceCode r">taxize_summ$pmcrefcount</code></pre>
<pre><code>## [1] 5</code></pre>
</div>
<div id="dealing-with-many-records" class="section level3">
<h3>Dealing with many records</h3>
<p>If you give <code>entrez_summary()</code> a vector with more than one ID you’ll get a list of summary records back. Let’s get those <em>Plasmodium vivax</em> papers we found in the <code>entrez_search()</code> section back, and fetch some summary data on each paper:</p>
<pre class="sourceCode r"><code class="sourceCode r">vivax_search &lt;-<span class="st"> </span><span class="kw">entrez_search</span>(<span class="dt">db =</span> <span class="st">&quot;pubmed&quot;</span>,
                              <span class="dt">term =</span> <span class="st">&quot;(vivax malaria[MeSH]) AND (folic acid antagonists[MeSH])&quot;</span>)
multi_summs &lt;-<span class="st"> </span><span class="kw">entrez_summary</span>(<span class="dt">db=</span><span class="st">&quot;pubmed&quot;</span>, <span class="dt">id=</span>vivax_search$ids)</code></pre>
<p><code>rentrez</code> provides a helper function, <code>extract_from_esummary()</code> that takes one or more elements from every summary record in one of these lists. Here it is working with one…</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">extract_from_esummary</span>(multi_summs, <span class="st">&quot;fulljournalname&quot;</span>)</code></pre>
<pre><code>##                                                                          24145518 
##                                           &quot;Antimicrobial agents and chemotherapy&quot; 
##                                                                          24007534 
##                                                                 &quot;Malaria journal&quot; 
##                                                                          23230341 
##                                              &quot;The Korean journal of parasitology&quot; 
##                                                                          23043980 
##                                                       &quot;Experimental parasitology&quot; 
##                                                                          20810806 
##                           &quot;The American journal of tropical medicine and hygiene&quot; 
##                                                                          20412783 
##                                                                    &quot;Acta tropica&quot; 
##                                                                          19597012 
##                                                   &quot;Clinical microbiology reviews&quot; 
##                                                                          17556611 
##                           &quot;The American journal of tropical medicine and hygiene&quot; 
##                                                                          17519409 
##                                                                            &quot;JAMA&quot; 
##                                                                          17368986 
##                                                          &quot;Trends in parasitology&quot; 
##                                                                          12374849 
## &quot;Proceedings of the National Academy of Sciences of the United States of America&quot;</code></pre>
<p>… and several elements:</p>
<pre class="sourceCode r"><code class="sourceCode r">date_and_cite &lt;-<span class="st"> </span><span class="kw">extract_from_esummary</span>(multi_summs, <span class="kw">c</span>(<span class="st">&quot;pubdate&quot;</span>, <span class="st">&quot;pmcrefcount&quot;</span>,  <span class="st">&quot;title&quot;</span>))
knitr::<span class="kw">kable</span>(<span class="kw">head</span>(<span class="kw">t</span>(date_and_cite)), <span class="dt">row.names=</span><span class="ot">FALSE</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">pubdate</th>
<th align="left">pmcrefcount</th>
<th align="left">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2014</td>
<td align="left">3</td>
<td align="left">Prevalence of polymorphisms in antifolate drug resistance molecular marker genes pvdhfr and pvdhps in clinical isolates of Plasmodium vivax from Kolkata, India.</td>
</tr>
<tr class="even">
<td align="left">2013 Sep 5</td>
<td align="left">2</td>
<td align="left">Prevalence and patterns of antifolate and chloroquine drug resistance markers in Plasmodium vivax across Pakistan.</td>
</tr>
<tr class="odd">
<td align="left">2012 Dec</td>
<td align="left">9</td>
<td align="left">Prevalence of drug resistance-associated gene mutations in Plasmodium vivax in Central China.</td>
</tr>
<tr class="even">
<td align="left">2012 Dec</td>
<td align="left">6</td>
<td align="left">Novel mutations in the antifolate drug resistance marker genes among Plasmodium vivax isolates exhibiting severe manifestations.</td>
</tr>
<tr class="odd">
<td align="left">2010 Sep</td>
<td align="left">13</td>
<td align="left">Mutations in the antifolate-resistance-associated genes dihydrofolate reductase and dihydropteroate synthase in Plasmodium vivax isolates from malaria-endemic countries.</td>
</tr>
<tr class="even">
<td align="left">2010 Sep</td>
<td align="left">5</td>
<td align="left">Plasmodium vivax in the Democratic Republic of East Timor: Parasite prevalence and antifolate resistance-associated mutations.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="fetching-full-records-entrez_fetch" class="section level2">
<h2>Fetching full records: <code>entrez_fetch()</code></h2>
<p>As useful as the summary records are, sometimes they just don’t have the information that you need. If you want a complete representation of a record you can use <code>entrez_fetch</code>, using the argument <code>rettype</code> to specify the format you’d like the record in.</p>
<div id="fetch-dna-sequences-in-fasta-format" class="section level3">
<h3>Fetch DNA sequences in fasta format</h3>
<p>Let’s extend the example given in the <code>entrez_link()</code> section about finding transcript for a given gene. This time we will fetch cDNA sequences of those transcripts.We can start by repeating the steps in the earlier example to get nucleotide IDs for refseq transcripts of two genes:</p>
<pre class="sourceCode r"><code class="sourceCode r">gene_ids &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">351</span>, <span class="dv">11647</span>)
linked_seq_ids &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">dbfrom=</span><span class="st">&quot;gene&quot;</span>, <span class="dt">id=</span>gene_ids, <span class="dt">db=</span><span class="st">&quot;nuccore&quot;</span>)
linked_transripts &lt;-<span class="st"> </span>linked_seq_ids$links$gene_nuccore_refseqrna
<span class="kw">head</span>(linked_transripts)</code></pre>
<pre><code>## [1] &quot;755509222&quot; &quot;755509221&quot; &quot;755509220&quot; &quot;568930486&quot; &quot;563317858&quot; &quot;563317856&quot;</code></pre>
<p>Now we can get our sequences with <code>entrez_fetch</code>, setting <code>rettype</code> to “fasta” (the list of formats available for <a href="http://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/">each database is give in this table</a>):</p>
<pre class="sourceCode r"><code class="sourceCode r">all_recs &lt;-<span class="st"> </span><span class="kw">entrez_fetch</span>(<span class="dt">db=</span><span class="st">&quot;nuccore&quot;</span>, <span class="dt">id=</span>linked_transripts, <span class="dt">rettype=</span><span class="st">&quot;fasta&quot;</span>)</code></pre>
<pre><code>## No encoding supplied: defaulting to UTF-8.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(all_recs)</code></pre>
<pre><code>## [1] &quot;character&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nchar</span>(all_recs)</code></pre>
<pre><code>## [1] 55475</code></pre>
<p>Congratulations, now you have a really huge character vector! Rather than printing all those thousands of bases we can take a peak at the top of the file:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="kw">strwrap</span>(<span class="kw">substr</span>(all_recs, <span class="dv">1</span>, <span class="dv">500</span>)), <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre>
<pre><code>## &gt;gi|755509222|ref|XM_006538499.2| PREDICTED: Mus musculus alkaline
## phosphatase, liver/bone/kidney (Alpl), transcript variant X3, mRNA
## CCGGGTGACTGCAGAGGATCGGAACGTCAATTAACGTCAATTAACATCTGACGCTGCCCCCCCCCCCCTC
## TTCCCACCATCTGGGCTCCAGCGAGGGACGAATCTCAGGGTACACCATGATCTCACCATTTTTAGTACTG
## GCCATCGGCACCTGCCTTACCAACTCTTTTGTGCCAGAGAAAGAGAGAGACCCCAGTTACTGGCGACAGC
## AAGCCCAAGAGACCTTGAAAAATGCCCTGAAACTCCAAAAGCTCAACACCAATGTAGCCAAGAATGTCAT
## CATGTTCCTGGGAGATGGTATGGGCGTCTCCACAGTAACCGCTGCCCGAATCCTTAAGGGCCAGCTACAC
## CACAACACGGG</code></pre>
<p>If we wanted to use these sequences in some other application we could write them to file:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write</span>(all_recs, <span class="dt">file=</span><span class="st">&quot;my_transcripts.fasta&quot;</span>)</code></pre>
<p>Alternatively, if you want to use them within an R session<br />we could write them to a temporary file then read that. In this case I’m using <code>read.dna()</code> from the pylogenetics package ape (but not executing the code block in this vignette, so you don’t have to install that package):</p>
<pre class="sourceCode r"><code class="sourceCode r">temp &lt;-<span class="st"> </span><span class="kw">tempfile</span>()
<span class="kw">write</span>(all_recs, temp)
parsed_recs &lt;-<span class="st"> </span>ape::<span class="kw">read.dna</span>(all_recs, temp)</code></pre>
</div>
<div id="fetch-a-parsed-xml-document" class="section level3">
<h3>Fetch a parsed XML document</h3>
<p>Most of the NCBI’s databases can return records in XML format. In additional to downloading the text-representation of these files, <code>entrez_fetch()</code> can return objects parsed by the <code>XML</code> package. As an example, we can check out the Taxonomy database’s record for (did I mention they are amazing….) <em>Tetrahymena thermophila</em>, specifying we want the result to be parsed by setting <code>parsed=TRUE</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">Tt &lt;-<span class="st"> </span><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;taxonomy&quot;</span>, <span class="dt">term=</span><span class="st">&quot;(Tetrahymena thermophila[ORGN]) AND Species[RANK]&quot;</span>)
tax_rec &lt;-<span class="st"> </span><span class="kw">entrez_fetch</span>(<span class="dt">db=</span><span class="st">&quot;taxonomy&quot;</span>, <span class="dt">id=</span>Tt$ids, <span class="dt">rettype=</span><span class="st">&quot;xml&quot;</span>, <span class="dt">parsed=</span><span class="ot">TRUE</span>)
<span class="kw">class</span>(tax_rec)</code></pre>
<pre><code>## [1] &quot;XMLInternalDocument&quot; &quot;XMLAbstractDocument&quot;</code></pre>
<p>The package XML (which you have if you have installed <code>rentrez</code>) provides functions to get information from these files. For relatively simple records like this one you can use <code>XML::xmlToList</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">tax_list &lt;-<span class="st"> </span>XML::<span class="kw">xmlToList</span>(tax_rec)
tax_list$Taxon$GeneticCode</code></pre>
<pre><code>## $GCId
## [1] &quot;6&quot;
## 
## $GCName
## [1] &quot;Ciliate Nuclear; Dasycladacean Nuclear; Hexamita Nuclear&quot;</code></pre>
<p>For more complex records, which generate deeply-nested lists, you can use <a href="https://en.wikipedia.org/wiki/XPath">XPath expressions</a> along with the function <code>XML::xpathSApply</code> or the extraction operatord <code>[</code> and <code>[[</code> to extract specific parts of the file. For instance, we can get the scientific name of each taxon in <em>T. thermophila</em>’s lineage by specifying a path through the XML</p>
<pre class="sourceCode r"><code class="sourceCode r">tt_lineage &lt;-<span class="st"> </span>tax_rec[<span class="st">&quot;//LineageEx/Taxon/ScientificName&quot;</span>]
tt_lineage[<span class="dv">1</span>:<span class="dv">4</span>]</code></pre>
<pre><code>## [[1]]
## &lt;ScientificName&gt;cellular organisms&lt;/ScientificName&gt; 
## 
## [[2]]
## &lt;ScientificName&gt;Eukaryota&lt;/ScientificName&gt; 
## 
## [[3]]
## &lt;ScientificName&gt;Alveolata&lt;/ScientificName&gt; 
## 
## [[4]]
## &lt;ScientificName&gt;Ciliophora&lt;/ScientificName&gt;</code></pre>
<p>As the name suggests, <code>XML::xpathSApply()</code> is a counterpart of base R’s <code>sapply</code>, and can be used to apply a function to nodes in an XML object. A particularly useful function to apply is <code>XML::xmlValue</code>, which returns the content of the node:</p>
<pre class="sourceCode r"><code class="sourceCode r">XML::<span class="kw">xpathSApply</span>(tax_rec, <span class="st">&quot;//LineageEx/Taxon/ScientificName&quot;</span>, XML::xmlValue)</code></pre>
<pre><code>##  [1] &quot;cellular organisms&quot; &quot;Eukaryota&quot;          &quot;Alveolata&quot;         
##  [4] &quot;Ciliophora&quot;         &quot;Intramacronucleata&quot; &quot;Oligohymenophorea&quot; 
##  [7] &quot;Hymenostomatida&quot;    &quot;Tetrahymenina&quot;      &quot;Tetrahymenidae&quot;    
## [10] &quot;Tetrahymena&quot;</code></pre>
<p>There are a few more complex examples of using <code>XPath</code> <a href="https://github.com/ropensci/rentrez/wiki">on the rentrez wiki</a></p>
<p><a name="web_history"></a></p>
</div>
</div>
<div id="using-ncbis-web-history-features" class="section level2">
<h2>Using NCBI’s Web History features</h2>
<p>When you are dealing with very large queries it can be time consuming to pass long vectors of unique IDs to and from the NCBI. To avoid this problem, the NCBI provides a feature called “web history” which allows users to store IDs on the NCBI servers then refer to them in future calls.</p>
<div id="post-a-set-of-ids-to-the-ncbi-for-later-use-entrez_post" class="section level3">
<h3>Post a set of IDs to the NCBI for later use: <code>entrez_post()</code></h3>
<p>If you have a list of many NCBI IDs that you want to use later on, you can post them to the NCBI’s severs. In order to provide a brief example, I’m going to post just one ID, the <code>omim</code> identifier for asthma:</p>
<pre class="sourceCode r"><code class="sourceCode r">upload &lt;-<span class="st"> </span><span class="kw">entrez_post</span>(<span class="dt">db=</span><span class="st">&quot;omim&quot;</span>, <span class="dt">id=</span><span class="dv">600807</span>)
upload</code></pre>
<pre><code>## Web history object (QueryKey = 1, WebEnv = NCID_1_13838...)</code></pre>
<p>The NCBI sends you back some information you can use to refer to the posted IDs. In <code>rentrez</code>, that information is represented as a <code>web_history</code> object.</p>
</div>
<div id="get-a-web_history-object-from-entrez_search-or-entrez_link" class="section level3">
<h3>Get a <code>web_history</code> object from <code>entrez_search</code> or <code>entrez_link()</code></h3>
<p>In addition to directly uploading IDs to the NCBI, you can use the web history features with <code>entrez_search</code> and <code>entrez_link</code>. For instance, imagine you wanted to find all of the sequences of the widely-studied gene COI from all snails (which are members of the taxonomic group Gastropoda):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;nuccore&quot;</span>, <span class="dt">term=</span><span class="st">&quot;COI[Gene] AND Gastropoda[ORGN]&quot;</span>)</code></pre>
<pre><code>## Entrez search result with 57291 hits (object contains 20 IDs and no web_history object)
##  Search term (as translated):  COI[Gene] AND &quot;Gastropoda&quot;[Organism]</code></pre>
<p>That’s a lot of sequences! If you really wanted to download all of these it would be a good idea to save all those IDs to the server by setting <code>use_history</code> to <code>TRUE</code> (note you now get a <code>web_history</code> object along with your normal search result):</p>
<pre class="sourceCode r"><code class="sourceCode r">snail_coi &lt;-<span class="st"> </span><span class="kw">entrez_search</span>(<span class="dt">db=</span><span class="st">&quot;nuccore&quot;</span>, <span class="dt">term=</span><span class="st">&quot;COI[Gene] AND Gastropoda[ORGN]&quot;</span>, <span class="dt">use_history=</span><span class="ot">TRUE</span>)
snail_coi</code></pre>
<pre><code>## Entrez search result with 57291 hits (object contains 20 IDs and a web_history object)
##  Search term (as translated):  COI[Gene] AND &quot;Gastropoda&quot;[Organism]</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">snail_coi$web_history</code></pre>
<pre><code>## Web history object (QueryKey = 1, WebEnv = NCID_1_13838...)</code></pre>
<p>Similarity, <code>entrez_link()</code> can return <code>web_history</code> objects by using the <code>cmd</code> <code>neighbor_history</code>. Let’s find genetic variants (from the clinvar database) associated with asthma (using the same OMIM ID we identified earlier):</p>
<pre class="sourceCode r"><code class="sourceCode r">asthma_clinvar &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">dbfrom=</span><span class="st">&quot;omim&quot;</span>, <span class="dt">db=</span><span class="st">&quot;clinvar&quot;</span>, <span class="dt">cmd=</span><span class="st">&quot;neighbor_history&quot;</span>, <span class="dt">id=</span><span class="dv">600807</span>)
asthma_clinvar$web_histories</code></pre>
<pre><code>## $omim_clinvar
## Web history object (QueryKey = 1, WebEnv = NCID_1_13838...)</code></pre>
<p>As you can see, instead of returning lists of IDs for each linked database (as it would be default), <code>entrez_link()</code> now returns a list of web_histories.</p>
</div>
<div id="use-a-web_history-object" class="section level3">
<h3>Use a <code>web_history</code> object</h3>
<p>Once you have those IDs stored on the NCBI’s servers, you are going to want to do something with them. The functions <code>entrez_fetch()</code> <code>entrez_summary()</code> and <code>entrez_link()</code> can all use <code>web_history</code> objects in exactly the same way they use IDs.</p>
<p>So, we could repeat the last example (finding variants linked to asthma), but this time using the ID we uploaded earlier</p>
<pre class="sourceCode r"><code class="sourceCode r">asthma_variants &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">dbfrom=</span><span class="st">&quot;omim&quot;</span>, <span class="dt">db=</span><span class="st">&quot;clinvar&quot;</span>, <span class="dt">cmd=</span><span class="st">&quot;neighbor_history&quot;</span>, <span class="dt">web_history=</span>upload)
asthma_variants</code></pre>
<pre><code>## elink object with contents:
##  $web_histories: Objects containing web history information</code></pre>
<p>… if we want to get some genetic information about these variants we need to map our clinvar IDs to SNP IDs:</p>
<pre class="sourceCode r"><code class="sourceCode r">snp_links &lt;-<span class="st"> </span><span class="kw">entrez_link</span>(<span class="dt">dbfrom=</span><span class="st">&quot;clinvar&quot;</span>, <span class="dt">db=</span><span class="st">&quot;snp&quot;</span>, 
                         <span class="dt">web_history=</span>asthma_variants$web_histories$omim_clinvar,
                         <span class="dt">cmd=</span><span class="st">&quot;neighbor_history&quot;</span>)
snp_summ &lt;-<span class="st"> </span><span class="kw">entrez_summary</span>(<span class="dt">db=</span><span class="st">&quot;snp&quot;</span>, <span class="dt">web_history=</span>snp_links$web_histories$clinvar_snp)
knitr::<span class="kw">kable</span>(<span class="kw">extract_from_esummary</span>(snp_summ, <span class="kw">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;fxn_class&quot;</span>, <span class="st">&quot;global_maf&quot;</span>)))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">41364547</th>
<th align="left">11558538</th>
<th align="left">2303067</th>
<th align="left">20541</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">chr</td>
<td align="left">11</td>
<td align="left">2</td>
<td align="left">5</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">fxn_class</td>
<td align="left">intron-variant,utr-variant-5-prime</td>
<td align="left">missense,reference,utr-variant-5-prime</td>
<td align="left">missense,reference</td>
<td align="left">missense,reference</td>
</tr>
<tr class="odd">
<td align="left">global_maf</td>
<td align="left">A=0.0036/18</td>
<td align="left">T=0.0595/298</td>
<td align="left">G=0.4331/2169</td>
<td align="left">A=0.2700/1352</td>
</tr>
</tbody>
</table>
<p>If you really wanted to you could also use <code>web_history</code> objects to download all those thousands of COI sequences. When downloading large sets of data, it is a good idea to take advantage of the arguments <code>retmax</code> and <code>restart</code> to split the request up into smaller chunks. For instance, we could get the first 200 sequences in 50-sequence chunks:</p>
<p>(note: this code block is not executed as part of the vignette to save time and bandwidth):</p>
<pre class="sourceCode r"><code class="sourceCode r">for( seq_start in <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">50</span>)){
    recs &lt;-<span class="st"> </span><span class="kw">entrez_fetch</span>(<span class="dt">db=</span><span class="st">&quot;nuccore&quot;</span>, <span class="dt">web_history=</span>snail_coi$web_history,
                         <span class="dt">rettype=</span><span class="st">&quot;fasta&quot;</span>, <span class="dt">retmax=</span><span class="dv">50</span>, <span class="dt">retstart=</span>seq_start)
    <span class="kw">cat</span>(recs, <span class="dt">file=</span><span class="st">&quot;snail_coi.fasta&quot;</span>, <span class="dt">append=</span><span class="ot">TRUE</span>)
    <span class="kw">cat</span>(seq_start<span class="dv">+49</span>, <span class="st">&quot;sequences downloaded</span><span class="ch">\r</span><span class="st">&quot;</span>)
}</code></pre>
</div>
</div>
<div id="what-next" class="section level2">
<h2>What next ?</h2>
<p>This tutorial has introduced you to the core functions of <code>rentrez</code>, there are almost limitless ways that you could put them together. <a href="https://github.com/ropensci/rentrez/wiki">Check out the wiki</a> for more specific examples, and be sure to read the inline-documentation for each function. If you run into problem with rentrez, or just need help with the package and <code>Eutils</code> please contact us by opening an issue at the <a href="https://github.com/ropensci/rentrez/issues">github repository</a></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
